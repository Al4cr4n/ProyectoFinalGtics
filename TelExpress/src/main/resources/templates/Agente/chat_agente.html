<!DOCTYPE html>
<html lang="en" class="light-style layout-menu-fixed" dir="ltr" data-theme="theme-default">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0" />
    <title>Chat Agente</title>
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="/logo.png"/>
    <link rel="stylesheet" href="/assets/vendor/fonts/boxicons.css" />
    <link rel="stylesheet" href="/assets/vendor/css/core.css" class="template-customizer-core-css" />
    <link rel="stylesheet" href="/assets/vendor/css/theme-default.css" class="template-customizer-theme-css" />
    <link rel="stylesheet" href="/assets/css/demo.css" />
    <link rel="stylesheet" href="/assets/vendor/libs/perfect-scrollbar/perfect-scrollbar.css" />
    <link rel="stylesheet" href="/assets/vendor/libs/apex-charts/apex-charts.css" />
    <script src="/assets/vendor/js/helpers.js"></script>
    <script src="/assets/js/config.js"></script>
    <!--FUENTES-->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
            href="https://fonts.googleapis.com/css2?family=Public+Sans:ital,wght@0,300;0,400;0,500;0,600;0,700;1,300;1,400;1,500;1,600;1,700&display=swap"
            rel="stylesheet"
    />
    <!--BOOTSTRAP Y BOXICONS-->
    <!-- importante aÃ±adir para que funcione las notificaciones y el icono de usuario-->
    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>


    <style>
        /* Custom styles for status labels */
        /*titulo de chat*/
        .chat-header h4 {
            font-family: 'Poppins', sans-serif;
            color: #ffffff;
            padding-left: 15px;
            font-weight: bolder;
            font-size: 25px;
            margin-bottom: -5px;
        }

        /*menu de contactos en chat*/
        .chat-sidebar h4{
            font-family: 'Poppins', sans-serif;
            font-weight: bolder;
        }
        .status-label {
            display: inline-block;
            padding: 5px 10px;
            border-radius: 5px;
            color: #fff;
            font-weight: bold;
        }
        .validacion { background-color: #d1bf00; }

        /* Sidebar icons */
        .menu-icon {
            margin-right: 8px;
        }

        /* Table styling */
        .table-bordered th, .table-bordered td {
            border: 1px solid #dee2e6;
        }

        /* Product images */
        .product-img {
            width: 50px;
            height: auto;
        }

        /* Communication Section */
        .communication-section {
            margin-top: 20px;
            display: flex;
            justify-content: space-between;
        }

        /* Shipping and Payment Details */
        .details-box {
            border: 1px solid #ccc;
            padding: 10px;
            margin-top: 20px;
        }

        /* Form styles */
        .details-box form {
            display: flex;
            flex-direction: column;
        }

        .details-box label {
            margin-top: 10px;
        }

        .details-box input {
            padding: 5px;
            margin-top: 5px;
        }

        /* Buttons */
        .btn-modify {
            background-color: #007bff;
            color: #fff;
            border: none;
            padding: 10px 20px;
            cursor: pointer;
            margin-right: 10px;
            text-decoration: none;
        }

        .btn-modify:hover {
            background-color: #0056b3;
        }

        .btn-delete {
            background-color: #dc3545;
            color: #fff;
            border: none;
            padding: 10px 20px;
            cursor: pointer;
        }

        .btn-delete:hover {
            background-color: #c82333;
        }

        .btn-save {
            background-color: #007bff;
            color: #fff;
            border: none;
            padding: 10px 20px;
            cursor: pointer;
            margin-top: 10px;
            align-self: flex-start;
        }

        .btn-save:hover {
            background-color: #0056b3;
        }

        /* Chat Interface Styles */
        .chat-wrapper {
            display: flex;
            width: 100%;
            height: 80vh;
            background-color: #fff;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            overflow: hidden;
            margin-top: 20px;
        }

        /* Sidebar */
        .chat-sidebar {
            width: 25%;
            background-color: #f8f8f8;
            border-right: 1px solid #ddd;
            padding: 20px;
        }

        .chat-sidebar h4 {
            margin-top: 0;
        }

        .contact {
            padding: 10px;
            margin-bottom: 5px;
            background-color: #e9ecef;
            border-radius: 5px;
            cursor: pointer;
            text-align: center;
        }

        .contact:hover {
            background-color: #ced4da;
        }

        /* Main Chat Area */
        .chat-area {
            display: flex;
            flex-direction: column;
            width: 75%;
            height: 100%;
        }

        .chat-header {
            padding: 20px;
            background-color: #ffb436;
            color: white;
            text-align: center;
            border-bottom: 1px solid #ddd;
        }

        .chat-body {
            flex-grow: 1;
            padding: 20px;
            overflow-y: auto;
            background-color: #f0f0f0;
        }

        .message {
            margin-bottom: 15px;
            display: flex;
        }

        .message .text {
            background-color: #fff;
            padding: 10px;
            border-radius: 5px;
            max-width: 70%;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .message.sent {
            justify-content: flex-end;
        }

        .message.received .text {
            background-color: #e1f5fe;
        }

        /* Chat Input */
        .chat-input-area {
            padding: 10px;
            background-color: #f8f8f8;
            display: flex;
            align-items: center;
        }

        #chat-input {
            flex-grow: 1;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }

        #send-btn {
            background-color: #0ccd90;
            color: white;
            border: none;
            padding: 10px;
            border-radius: 5px;
            margin-left: 10px;
            cursor: pointer;
        }

        #send-btn:hover {
            background-color: #0056b3;
        }
    </style>
</head>
<body>
<!-- Layout wrapper -->
<div class="layout-wrapper layout-content-navbar">
    <div class="layout-container">
        <div th:insert="~{Agente/fragments/menu.html::menu}"></div> <!-- este es el menu -->
        <!-- Layout container -->
        <div class="layout-page">
            <div th:insert="~{Agente/fragments/navbar.html::navbar}"></div> <!-- este es el navbar -->

            <!-- Content wrapper -->
            <div class="content-wrapper">
                <!-- Order Details -->
                <div class="container-xxl flex-grow-1 container-p-y">

                    <!-- Chat Interface -->
                    <div class="chat-wrapper">
                        <!-- Sidebar for Contacts -->
                        <div class="chat-sidebar">
                            <h4>Contactos</h4>
                            <div class="contact" onclick="selectContact('Usuario01')">Usuario01</div>
                            <div class="contact" onclick="selectContact('Usuario02')">Usuario02</div>
                            <div class="contact" onclick="selectContact('Usuario03')">Usuario03</div>
                            <div class="contact" onclick="selectContact('Usuario04')">Usuario04</div>
                            <div class="contact" onclick="selectContact('Usuario05')">Usuario05</div>
                        </div>

                        <!-- Main Chat Area -->
                        <div class="chat-area">
                            <div class="chat-header">
                                <h4 id="chat-with">Chat</h4>
                            </div>
                            <div class="chat-body" id="chat-body">
                                <!-- Chat messages will be appended here dynamically -->
                            </div>
                            <div class="chat-input-area">
                                <input type="text" class="form-control" id="message-input" placeholder="Type your message here...">
                                <button onclick="sendMessage()" class="btn btn-primary mt-3">Send</button>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
            <!-- /Content wrapper -->
        </div>
        <!-- /Main content -->
    </div>
    <!-- / Layout page -->
</div>

<!-- JavaScript for Chat Functionality -->
<script th:inline ="javascript">
    let socket = new WebSocket("ws://localhost:8080/chatSocket")

    socket.onmessage = function(event) {
        let messageArea = document.getElementById("messageArea");
        messageArea.innerHTML += '<p>' + event.data + '</p>';
    };

    function sendMessage() {

        let messageInput = document.getElementById("messageInput");

        let fullMessage = "Agente" + ": " + messageInput.value;
        socket.send(fullMessage);
        messageInput.value = '';
    }

</script>

</body>
</html>
